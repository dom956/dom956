name: Update GitHub Profile README

on:
  schedule:
    - cron: "0 */6 * * *" # Runs every 6 hours
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  update-readme:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Fetch Commit Activity & Languages
        env:
          GH_PAT: ${{ secrets.GH_PAT }}
        run: |
          curl -H "Authorization: token $GH_PAT" https://api.github.com/users/YOUR_GITHUB_USERNAME/repos > repos.json
          cat repos.json | jq -r '.[] | "\(.name) - \(.language)"' > languages.txt
          curl -H "Authorization: token $GH_PAT" https://api.github.com/repos/YOUR_GITHUB_USERNAME/YOUR_REPO/commits > commits.json
          cat commits.json | jq -r '.[0:5] | .[].commit.message' > commits.txt

      - name: Update README
        run: |
          echo "## ðŸš€ Recent Commits" > README.md
          cat commits.txt >> README.md
          echo "" >> README.md
          echo "## ðŸŒ Languages Used" >> README.md
          cat languages.txt >> README.md

      - name: Commit and Push Changes
        run: |
          git config --global user.name "GitHub Actions Bot"
          git config --global user.email "actions@github.com"
          git add README.md
          git commit -m "ðŸ”„ Auto-update README with latest commits & languages" || exit 0
          git push
